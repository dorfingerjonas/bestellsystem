"use strict";(self.webpackChunkordersystem=self.webpackChunkordersystem||[]).push([[927],{6927:(x,m,o)=>{o.r(m),o.d(m,{OrderModule:()=>$});var p=o(177),t=o(7705),u=o(52),C=o(8490),_=o(1359),f=o(5416),D=o(4796),g=o(6600),k=o(9631),h=o(9417),O=o(4449);function v(n,c){if(1&n){const e=t.RV6();t.j41(0,"app-order-category",9),t.bIt("itemsChange",function(r){t.eBV(e);const i=t.XpG();return t.Njj(i.alcoholDrinks=r)}),t.k0s()}if(2&n){const e=t.XpG();t.Y8G("items",e.alcoholDrinks)}}function y(n,c){if(1&n){const e=t.RV6();t.j41(0,"app-order-category",10),t.bIt("itemsChange",function(r){t.eBV(e);const i=t.XpG();return t.Njj(i.antiDrinks=r)}),t.k0s()}if(2&n){const e=t.XpG();t.Y8G("items",e.antiDrinks)}}function N(n,c){if(1&n){const e=t.RV6();t.j41(0,"app-order-category",11),t.bIt("itemsChange",function(r){t.eBV(e);const i=t.XpG();return t.Njj(i.food=r)}),t.k0s()}if(2&n){const e=t.XpG();t.Y8G("items",e.food)}}function b(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span"),t.EFF(2),t.k0s()()),2&n){const e=c.$implicit;t.R7$(2),t.Lme("",e.amount," x ",e.name,"")}}function G(n,c){if(1&n&&(t.j41(0,"div",12)(1,"span"),t.EFF(2),t.k0s()()),2&n){const e=c.$implicit;t.R7$(2),t.Lme("",e.amount," x ",e.name,"")}}function E(n,c){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG();t.R7$(1),t.SpI("Notiz: ",e.orderNotes,"")}}function I(n,c){1&n&&(t.j41(0,"span",13),t.EFF(1,"Der Warenkorb ist leer"),t.k0s())}function T(n,c){if(1&n){const e=t.RV6();t.j41(0,"button",14),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.order())}),t.EFF(1,"Bestellen "),t.k0s()}}let j=(()=>{class n{constructor(e,s,r,i,d){this.route=e,this.data=s,this.header=r,this.snackBar=i,this.auth=d,this.selectedTableNr=this.route.snapshot.params.tableNr,this.header.text=`Tisch ${this.selectedTableNr}`,this.data.fetchData(),this.alcoholDrinks=null,this.antiDrinks=null,this.food=null,this.orderSent=!1,this.data.food.subscribe(l=>{this.food=l.map(a=>({...a,amount:0}))}),this.data.drinks.subscribe(l=>{this.alcoholDrinks=[],this.antiDrinks=[];for(const a of l)if("alcohol"===a.category)this.alcoholDrinks.push({...a,amount:0});else{if("anti"!==a.category)throw new Error("Invalid Drink category"+a.category);this.antiDrinks.push({...a,amount:0})}})}getOrderDetails(){return null===this.antiDrinks||null===this.alcoholDrinks||null===this.food?null:{drinks:[...this.alcoholDrinks.filter(e=>(e.amount||0)>0),...this.antiDrinks.filter(e=>(e.amount||0)>0)],food:this.food.filter(e=>(e.amount||0)>0),table:{nr:this.selectedTableNr},waiter:this.auth.username,timestamp:Date.now(),id:Date.now(),note:this.orderNotes||""}}order(){const e=this.getOrderDetails();e&&(this.orderSent||(this.orderSent=!0,this.data.createOrder(e).then(s=>{this.food?.forEach(r=>r.amount=0),this.alcoholDrinks?.forEach(r=>r.amount=0),this.antiDrinks?.forEach(r=>r.amount=0),this.orderNotes=void 0,this.orderSent=!1,document.getElementsByClassName("page-container")[0].scrollTop=0,this.snackBar.open("Bestellung erfolgreich aufgegeben.","X",{duration:2500})}).catch(s=>{this.snackBar.open("Es ist ein Fehler aufgetreten.","X",{duration:2500}),console.log(s),this.orderSent=!1})))}static{this.\u0275fac=function(s){return new(s||n)(t.rXU(u.nX),t.rXU(C.u),t.rXU(_.d),t.rXU(f.UG),t.rXU(D.u))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-order"]],decls:12,vars:9,consts:[["title","alkoholische Getr\xe4nke",3,"items","itemsChange",4,"ngIf"],["title","anti-alkoholische Getr\xe4nke",3,"items","itemsChange",4,"ngIf"],["title","Speisen",3,"items","itemsChange",4,"ngIf"],["matInput","","placeholder","Anmerkung/Notiz",3,"ngModel","ngModelChange"],["id","cart-wrapper"],["class","item",4,"ngFor","ngForOf"],[4,"ngIf"],["class","error",4,"ngIf"],["class","button btn-ok","matRipple","",3,"click",4,"ngIf"],["title","alkoholische Getr\xe4nke",3,"items","itemsChange"],["title","anti-alkoholische Getr\xe4nke",3,"items","itemsChange"],["title","Speisen",3,"items","itemsChange"],[1,"item"],[1,"error"],["matRipple","",1,"button","btn-ok",3,"click"]],template:function(s,r){if(1&s&&(t.DNE(0,v,1,1,"app-order-category",0),t.DNE(1,y,1,1,"app-order-category",1),t.DNE(2,N,1,1,"app-order-category",2),t.j41(3,"textarea",3),t.bIt("ngModelChange",function(d){return r.orderNotes=d}),t.k0s(),t.j41(4,"div",4)(5,"h2"),t.EFF(6,"Warenkorb"),t.k0s(),t.DNE(7,b,3,2,"div",5),t.DNE(8,G,3,2,"div",5),t.DNE(9,E,2,1,"span",6),t.DNE(10,I,2,0,"span",7),t.DNE(11,T,2,0,"button",8),t.k0s()),2&s){let i,d,l,a;t.Y8G("ngIf",r.alcoholDrinks),t.R7$(1),t.Y8G("ngIf",r.antiDrinks),t.R7$(1),t.Y8G("ngIf",r.food),t.R7$(1),t.Y8G("ngModel",r.orderNotes),t.R7$(4),t.Y8G("ngForOf",null==(i=r.getOrderDetails())?null:i.drinks),t.R7$(1),t.Y8G("ngForOf",null==(d=r.getOrderDetails())?null:d.food),t.R7$(1),t.Y8G("ngIf",r.orderNotes&&r.orderNotes.length>0),t.R7$(1),t.Y8G("ngIf",0===(null==(l=r.getOrderDetails())||null==l.food?null:l.food.length)&&0===(null==(l=r.getOrderDetails())||null==l.drinks?null:l.drinks.length)),t.R7$(1),t.Y8G("ngIf",0!==(null==(a=r.getOrderDetails())||null==a.food?null:a.food.length)||0!==(null==(a=r.getOrderDetails())||null==a.drinks?null:a.drinks.length))}},dependencies:[p.Sq,p.bT,g.r6,k.fg,h.me,h.BC,h.vS,O.A],styles:["textarea[_ngcontent-%COMP%]{width:70%;height:15%;resize:none;outline:none;margin:10% 15% 0;font-family:Roboto,Helvetica Neue,sans-serif;border:2px solid var(--table-accent);border-radius:5px;transition:border-color .15s ease-in-out;font-size:4vw}textarea[_ngcontent-%COMP%]:focus{border-color:var(--accent)}#cart-wrapper[_ngcontent-%COMP%]{width:100%;box-sizing:border-box;padding:0 20% 20%}#cart-wrapper[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center}#cart-wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;margin-top:3vh}#cart-wrapper[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{display:block;text-align:center}"]})}}return n})();var F=o(1801),R=o(8834),M=o(5553);const X=[{path:"",component:j}];let $=(()=>{class n{static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({imports:[p.MD,u.iI.forChild(X),F.m_,g.pZ,R.Hl,k.fS,h.YN,f._T,M.h]})}}return n})()}}]);