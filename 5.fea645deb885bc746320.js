(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{tPZM:function(t,n,e){"use strict";e.r(n),e.d(n,"OrderModule",function(){return M});var i=e("ofXK"),o=e("tyNb"),s=e("6NWb"),r=e("wHSu"),c=e("fXoL"),a=e("7ch9"),d=e("hErN"),l=e("sSZD");let b=(()=>{class t{constructor(t){this.db=t,this.drinks=this.db.object("drinks").valueChanges()}}return t.\u0275fac=function(n){return new(n||t)(c.Rb(l.a))},t.\u0275prov=c.Gb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),h=(()=>{class t{constructor(t){this.db=t,this.food=this.db.object("food").valueChanges()}}return t.\u0275fac=function(n){return new(n||t)(c.Rb(l.a))},t.\u0275prov=c.Gb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),u=(()=>{class t{constructor(t){this.db=t}persist(t){return this.db.list("stats/orders").push(t),new Promise((n,e)=>{this.db.list("orders").push(t).then(t=>n()).catch(t=>e())})}}return t.\u0275fac=function(n){return new(n||t)(c.Rb(l.a))},t.\u0275prov=c.Gb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var g=e("lGQG");const f=function(){return{color:"var(--dark-gray)"}};function p(t,n){if(1&t){const t=c.Ob();c.Nb(0,"div",4),c.Ub("click",function(){const t=n.$implicit;return t.amount=(t.amount||0)+1}),c.Nb(1,"span",5),c.kc(2),c.Mb(),c.Nb(3,"span",6),c.kc(4),c.Mb(),c.Nb(5,"span",7),c.kc(6),c.Mb(),c.Nb(7,"span",8),c.Ub("click",function(){c.fc(t);const e=n.$implicit;return c.Wb(2).decreaseAmount(e)}),c.Lb(8,"fa-icon",9),c.Mb(),c.Mb()}if(2&t){const t=n.$implicit,e=c.Wb(2);c.Ab(2),c.lc(t.amount||0),c.Ab(2),c.lc(t.name),c.Ab(2),c.mc("",t.price,"\u20ac"),c.Ab(2),c.bc("icon",e.minusIcon)("styles",c.dc(5,f))}}function m(t,n){if(1&t&&(c.Nb(0,"div",2),c.Nb(1,"span"),c.kc(2),c.Mb(),c.jc(3,p,9,6,"div",3),c.Mb()),2&t){const t=n.$implicit;c.Ab(2),c.lc(t.title),c.Ab(1),c.bc("ngForOf",t.items)}}const y=[{path:"",component:(()=>{class t{constructor(t,n,e,i,o,s,c){this.router=t,this.loading=n,this.header=e,this.drinkService=i,this.foodService=o,this.orderService=s,this.auth=c,this.minusIcon=r.c,this.subscriptions=[],this.displayTable=[],this.drinks=[],this.food=[],this.tableNr=parseInt(this.router.url.replace("/order/",""),0)}ngOnInit(){setTimeout(()=>this.header.text=`Tisch: ${this.tableNr}`);let t=this.drinkService.drinks.subscribe(t=>{this.drinks=t,this.buildDisplayTable()});this.subscriptions.push(t),t=this.foodService.food.subscribe(t=>{this.food=t,this.buildDisplayTable()}),this.subscriptions.push(t)}ngOnDestroy(){this.subscriptions.forEach(t=>{t.unsubscribe()})}decreaseAmount(t){t.amount&&t.amount>0&&(t.amount=t.amount-2)}order(){const t={id:Date.now(),drinks:this.drinks.filter(t=>(t.amount||0)>0),food:this.food.filter(t=>(t.amount||0)>0),table:{nr:this.tableNr},timestamp:Date.now(),waiter:this.auth.username};this.loading.activateLoading(),this.orderService.persist(t).then(t=>{this.loading.deactivateLoading(),this.router.navigateByUrl("/tables")}).catch(t=>{this.loading.deactivateLoading()})}buildDisplayTable(){this.displayTable=[{title:"alkoholische Getr\xe4nke",items:this.drinks.filter(t=>"alcohol"===t.category)},{title:"alkoholfreie Getr\xe4nke",items:this.drinks.filter(t=>"anti"===t.category)},{title:"Speisen",items:this.food}],this.loading.deactivateLoading()}isOrderValid(){const t=this.drinks.filter(t=>(t.amount||0)>0),n=this.food.filter(t=>(t.amount||0)>0);return t.length>0||n.length>0}}return t.\u0275fac=function(n){return new(n||t)(c.Kb(o.b),c.Kb(a.a),c.Kb(d.a),c.Kb(b),c.Kb(h),c.Kb(u),c.Kb(g.a))},t.\u0275cmp=c.Eb({type:t,selectors:[["app-order"]],decls:3,vars:2,consts:[["class","category",4,"ngFor","ngForOf"],[1,"button","btn-danger",3,"disabled","click"],[1,"category"],["class","item",3,"click",4,"ngFor","ngForOf"],[1,"item",3,"click"],[1,"amount"],[1,"name"],[1,"price"],[1,"minus",3,"click"],[3,"icon","styles"]],template:function(t,n){1&t&&(c.jc(0,m,4,2,"div",0),c.Nb(1,"button",1),c.Ub("click",function(){return n.order()}),c.kc(2,"Bestellen"),c.Mb()),2&t&&(c.bc("ngForOf",n.displayTable),c.Ab(1),c.bc("disabled",!n.isOrderValid()))},directives:[i.i,s.a],styles:["[_nghost-%COMP%]{width:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .category[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{width:100%;display:block;background:var(--lighter);font-size:4vw;font-weight:bolder;padding:1% 2%;box-sizing:border-box}[_nghost-%COMP%]   .category[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{padding:1%;box-sizing:border-box;font-size:3vw;display:flex;flex-direction:row;z-index:99}[_nghost-%COMP%]   .category[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:nth-child(2n-1){background:var(--table-accent)}[_nghost-%COMP%]   .category[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{width:10%;display:flex;justify-content:center}[_nghost-%COMP%]   .category[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{width:60%;display:flex;justify-content:flex-start}[_nghost-%COMP%]   .category[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{width:10%;display:flex;justify-content:center}[_nghost-%COMP%]   .category[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .minus[_ngcontent-%COMP%]{width:20%;display:flex;justify-content:center;align-items:center;z-index:101}[_nghost-%COMP%]   .category[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .minus[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{width:4vw;height:4vw;background:var(--dark-gray);color:var(--white);display:flex;justify-content:center;align-items:center;border-radius:50%}[_nghost-%COMP%]   .button[_ngcontent-%COMP%]{width:80%;margin:15% 10%;transition:all .3s ease-in-out}"]}),t})()}];let M=(()=>{class t{}return t.\u0275mod=c.Ib({type:t}),t.\u0275inj=c.Hb({factory:function(n){return new(n||t)},imports:[[i.c,o.d.forChild(y),s.b]]}),t})()}}]);